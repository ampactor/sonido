#!/usr/bin/env bash
# Pre-push hook: fast compilation gate (~5s warm).
# Catches type errors in lib, bin, benches, examples, and tests.
# Full lint/test/no_std/wasm runs in CI after push lands.
# Install via: make install-hooks
# Skip via:    SKIP_CI=1 git push

set -euo pipefail

if [[ "${SKIP_CI:-0}" == "1" ]]; then
  echo "SKIP_CI=1 set, skipping pre-push checks"
  exit 0
fi

echo "Running pre-push checks..."
cargo fmt --all -- --check
cargo check --workspace --all-targets
cargo check --target wasm32-unknown-unknown -p sonido-gui
echo "Pre-push checks passed."
